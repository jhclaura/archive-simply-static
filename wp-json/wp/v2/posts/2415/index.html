{"id":2415,"date":"2015-09-19T12:02:59","date_gmt":"2015-09-19T17:02:59","guid":{"rendered":"http:\/\/www.jhclaura.com\/?p=2415"},"modified":"2015-09-19T16:28:22","modified_gmt":"2015-09-19T21:28:22","slug":"mask-v2-0-local-closed-network","status":"publish","type":"post","link":"http:\/\/www.jhclaura.com\/mask-v2-0-local-closed-network\/","title":{"rendered":"MASK v2.0 &#8211; Local server(*2) network!"},"content":{"rendered":"<p><a href=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-18-at-8.40.12-PM.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2453\" src=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-18-at-8.40.12-PM.png\" alt=\"Screen Shot 2015-09-18 at 8.40.12 PM\" width=\"1000\" height=\"625\" srcset=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-18-at-8.40.12-PM.png 1000w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-18-at-8.40.12-PM-300x188.png 300w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-18-at-8.40.12-PM-400x250.png 400w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-18-at-8.40.12-PM-210x131.png 210w\" sizes=\"(max-width: 1000px) 100vw, 1000px\" \/><\/a><\/p>\n<p>Quick notes on how I made\u00a0local Peer.js server, and also closed network!<\/p>\n<p>When making my thesis, I used cloud hosted PeerServer with API key, so the project was constrained by\u00a0internet access. In order to make the project more robust and stable, I decided to create PeerServer on my own laptop,\u00a0and let devices (mobile phones) access the\u00a0laptop (server) through Wi-Fi.<\/p>\n<p>Here are the quick notes on how I did those\u00a0(OMG such a googling \/ debugging hell!):<\/p>\n<p>&nbsp;<\/p>\n<p><strong><span style=\"font-family: 'Andale Mono', Times;\">Create PeerServer accompanying\u00a0another\u00a0WebSocket system<\/span><\/strong><\/p>\n<p>Peer.js documented well about how to create your own PeerServer, even with examples\u00a0of <a href=\"https:\/\/github.com\/peers\/peerjs-server#combining-with-existing-express-app\" target=\"_blank\">combining with existing express app<\/a>, which is perfect for me. But because I have my own Node server as well, I struggled for a while to realize that, I should create two servers for each websocket with different ports!!! Finding\u00a0this out through non-stop console.log and try &amp; error!<\/p>\n<p><span style=\"font-family: 'Andale Mono', Times;\"><em>Server codes<\/em><\/span><\/p>\n<pre class=\"brush: javascript; gutter: true\">var express = require(&#039;express&#039;);\r\nvar app = express();\r\nvar http = require(&#039;http&#039;);\r\nvar server = http.createServer(app);\r\nvar port = process.env.PORT || 7000;\r\n\r\n\/\/ peer_server\r\nvar ExpressPeerServer = require(&#039;peer&#039;).ExpressPeerServer;\r\nvar peerExpress = require(&#039;express&#039;);\r\nvar peerApp = peerExpress();\r\nvar peerServer = require(&#039;http&#039;).createServer(peerApp);\r\nvar options = { debug: true }\r\nvar peerPort = 9000;\r\n\r\napp.get(&#039;*&#039;, function(req, res){\r\n    res.sendFile(__dirname + req.url);\r\n});\r\npeerApp.use(&#039;\/pp&#039;, ExpressPeerServer(peerServer, options));\r\n\r\nserver.listen(port);\r\npeerServer.listen(peerPort);<\/pre>\n<p>&nbsp;<\/p>\n<p><span style=\"font-family: 'Andale Mono', Times;\"><em>Client side\u00a0sudocode<\/em><\/span><\/p>\n<pre class=\"brush: javascript; gutter: true\">var peerConnect = function() {\t\t\t\r\n\t\/* WebRTC - Peer.js *\/\r\n\tpeer = new Peer( ID(), { secure: false, host: &#039;YOUR_IP&#039;, port: 5000, path:&#039;\/pp&#039;, debug:true} );\r\n\r\n\t\/\/ Get an ID from the PeerJS server\t\t\r\n\tpeer.on(&#039;open&#039;, function(id) {\r\n\t\tconsole.log(&#039;My peer ID is: &#039; + id);\r\n\t\tpeer_id = id;\r\n\r\n\t\t\/\/ Now we can connect to my socket server\t\t\t\t\t\t\r\n\t\tconnectSocket();\r\n\t});\r\n\r\n\tpeer.on(&#039;call&#039;, function(incoming_call) {\r\n\t\tconsole.log(&quot;Got a call!&quot;);\r\n\t\tincoming_call.answer(my_stream); \/\/ Answer the call with an A\/V stream.\r\n\t\t\/\/ do what you want~~~\r\n\t});\r\n};<\/pre>\n<p>&nbsp;<\/p>\n<p><span style=\"font-family: 'Andale Mono', Times;\"><strong>MacbookPro as server, accessing by devices through Wi-Fi with router<\/strong><\/span><\/p>\n<ol>\n<li>Connect Router with MacbookPro<\/li>\n<li>Click Wi-Fi symbol to expand the list &#8211;&gt; Create Network&#8230;<a href=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.43.25-PM.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2445\" src=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.43.25-PM.png\" alt=\"Screen Shot 2015-09-19 at 12.43.25 PM\" width=\"368\" height=\"765\" srcset=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.43.25-PM.png 368w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.43.25-PM-144x300.png 144w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.43.25-PM-210x437.png 210w\" sizes=\"(max-width: 368px) 100vw, 368px\" \/><\/a><\/li>\n<li>Setup name and password<a href=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.44.53-PM.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2446\" src=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.44.53-PM.png\" alt=\"Screen Shot 2015-09-19 at 12.44.53 PM\" width=\"448\" height=\"370\" srcset=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.44.53-PM.png 448w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.44.53-PM-300x248.png 300w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.44.53-PM-400x330.png 400w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.44.53-PM-210x173.png 210w\" sizes=\"(max-width: 448px) 100vw, 448px\" \/><\/a><\/li>\n<li>System Preferences&#8230; &#8211;&gt; Sharing<a href=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.46.06-PM.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2447\" src=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.46.06-PM.png\" alt=\"Screen Shot 2015-09-19 at 12.46.06 PM\" width=\"661\" height=\"544\" srcset=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.46.06-PM.png 661w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.46.06-PM-300x247.png 300w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.46.06-PM-400x329.png 400w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.46.06-PM-210x173.png 210w\" sizes=\"(max-width: 661px) 100vw, 661px\" \/><\/a>\n<ul>\n<li>Setup computer name<\/li>\n<li>Click Internet Sharing<\/li>\n<li>Share your connection from: Ethernet<\/li>\n<li>To computer using: Wi-Fi<\/li>\n<li>Click Wi-Fi Options &#8211;&gt; setup Wi-Fi name and password<a href=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.48.59-PM.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2448\" src=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.48.59-PM.png\" alt=\"Screen Shot 2015-09-19 at 12.48.59 PM\" width=\"662\" height=\"541\" srcset=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.48.59-PM.png 662w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.48.59-PM-300x245.png 300w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.48.59-PM-400x327.png 400w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.48.59-PM-210x172.png 210w\" sizes=\"(max-width: 662px) 100vw, 662px\" \/><\/a><\/li>\n<li>Click on box next to\u00a0Internet Sharing to start<a href=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.50.45-PM.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2449\" src=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.50.45-PM.png\" alt=\"Screen Shot 2015-09-19 at 12.50.45 PM\" width=\"662\" height=\"543\" srcset=\"http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.50.45-PM.png 662w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.50.45-PM-300x246.png 300w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.50.45-PM-400x328.png 400w, http:\/\/www.jhclaura.com\/wp-content\/uploads\/2015\/09\/Screen-Shot-2015-09-19-at-12.50.45-PM-210x172.png 210w\" sizes=\"(max-width: 662px) 100vw, 662px\" \/><\/a><\/li>\n<\/ul>\n<\/li>\n<li>@\u00a0your device&#8217;s Wi-Fi list, choose the Wi-Fi shared by MacbookPro and enter password<\/li>\n<li>Voila! Now your device and MacbookPro have same IP address, thus the device and go to the page that MacbookPro serves with &lt;IP_address&gt;:7000\/index.html.<\/li>\n<\/ol>\n","protected":false},"excerpt":{"rendered":"<p>Quick notes on how I made\u00a0local Peer.js server, and also closed network! When making my thesis, I used cloud hosted PeerServer with API key, so the project was constrained by\u00a0internet&#8230; <a class=\"read-more\" href=\"http:\/\/www.jhclaura.com\/mask-v2-0-local-closed-network\/\">Read The Rest &rarr;<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[127,268],"tags":[281,285,282,283,284],"_links":{"self":[{"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/posts\/2415"}],"collection":[{"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/comments?post=2415"}],"version-history":[{"count":10,"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/posts\/2415\/revisions"}],"predecessor-version":[{"id":2456,"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/posts\/2415\/revisions\/2456"}],"wp:attachment":[{"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/media?parent=2415"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/categories?post=2415"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/www.jhclaura.com\/wp-json\/wp\/v2\/tags?post=2415"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}